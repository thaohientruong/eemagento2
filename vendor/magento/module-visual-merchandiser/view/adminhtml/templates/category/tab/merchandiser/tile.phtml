<?php
/**
 * Copyright Â© 2016 Magento. All rights reserved.
 * See COPYING.txt for license details.
 */

// @codingStandardsIgnoreFile

?>
<?php /** @var \Magento\VisualMerchandiser\Block\Adminhtml\Category\Tab\Merchandiser\Tile $block */ ?>
<?php
/** @var \Magento\Catalog\Helper\Image $imageBlock */
$imageHelper =  $block->getImageHelper();
?>
<div data-role="catalog_category_merchandiser">
    <div class="admin__data-grid-header admin__data-grid-toolbar">
        <div class="admin__data-grid-header-row"> </div>
        <div class="admin__data-grid-header-row">
            <div class="admin__control-support-text">
                <?php $countRecords = $block->getCollection()->getSize(); ?>
                <span id="<?php echo $block->getHtmlId() ?>-total-count" <?php /* @escapeNotVerified */ echo $block->getUiId('total-count') ?>><?php /* @escapeNotVerified */ echo $countRecords ?></span> <?php /* @escapeNotVerified */ echo __('records found') ?>
            </div>
            <?php if ($block->getPagerVisibility()): ?>
                <div class="admin__data-grid-pager-wrap">
                    <select name="<?php /* @escapeNotVerified */ echo $block->getVarNameLimit() ?>"
                            id="<?php echo $block->getHtmlId()?>_page-limit"
                            data-role="page_limiter"
                            class="admin__control-select">
                        <?php foreach([20, 30, 50, 100, 200] as $perPageSize): ?>
                            <option value="<?php /* @escapeNotVerified */ echo $perPageSize ?>"<?php if ($block->getCollection()->getPageSize() == $perPageSize): ?>
                                selected="selected"<?php endif; ?>><?php /* @escapeNotVerified */ echo $perPageSize ?>
                            </option>
                        <?php endforeach; ?>
                    </select>
                    <label for="<?php echo $block->getHtmlId()?><?php echo $block->getHtmlId()?>_page-limit"
                           class="admin__control-support-text"><?php /* @escapeNotVerified */ echo __('per page') ?></label>

                    <div class="admin__data-grid-pager">
                        <?php $_curPage = $block->getCollection()->getCurPage() ?>
                        <?php $_lastPage = $block->getCollection()->getLastPageNumber() ?>
                        <?php if ($_curPage > 1): ?>
                            <button class="action-previous"
                                    type="button"
                                    data-role="button_previous"
                                    data-value="<?php /* @escapeNotVerified */ echo($_curPage - 1) ?>">
                                <span><?php /* @escapeNotVerified */ echo __('Previous page') ?></span>
                            </button>
                        <?php else: ?>
                            <button type="button" class="action-previous disabled"><span><?php /* @escapeNotVerified */ echo __('Previous page') ?></span></button>
                        <?php endif; ?>
                        <input type="text"
                               id="<?php echo $block->getHtmlId()?>_page-current"
                               name="<?php /* @escapeNotVerified */ echo $block->getVarNamePage() ?>"
                               value="<?php /* @escapeNotVerified */ echo $_curPage ?>"
                               class="admin__control-text"
                               data-role="input_page"
                               <?php /* @escapeNotVerified */ echo $block->getUiId('current-page') ?> />
                        <label class="admin__control-support-text" for="<?php echo $block->getHtmlId()?>_page-current">
                            <?php /* @escapeNotVerified */ echo __('of %1', '<span>' . $block->getCollection()->getLastPageNumber() . '</span>') ?>
                        </label>
                        <?php if ($_curPage < $_lastPage): ?>
                            <button type="button"
                                    title="<?php /* @escapeNotVerified */ echo __('Next page') ?>"
                                    class="action-next"
                                    data-role="button_next"
                                    data-value="<?php /* @escapeNotVerified */ echo($_curPage + 1) ?>">
                                <span><?php /* @escapeNotVerified */ echo __('Next page') ?></span>
                            </button>
                        <?php else: ?>
                            <button type="button" class="action-next disabled"><span><?php /* @escapeNotVerified */ echo __('Next page') ?></span></button>
                        <?php endif; ?>
                    </div>
                </div>
            <?php endif ?>
        </div>
    </div>

    <?php if ($block->getCollection()): ?>
        <div class="admin__data-grid-wrap admin__data-grid-wrap-static">
            <div class="hor-scroll">
                <ul id="catalog_category_merchandiser_list">
                    <?php foreach ($block->getCollection() as $_index => $_product): ?>
                        <?php /** @var \Magento\Catalog\Model\Product $_item */ ?>
                        <li class="product_tile">
                            <div class="controlbar-top">
                                <a href="#" class="icon-gripper"><span><?php /* @escapeNotVerified */ echo __('Draggable') ?></span></a>
                                <a href="#" class="remove-product icon-close-mage"><span><?php /* @escapeNotVerified */ echo __('Close') ?></span></a>
                            </div>
                            <div class="image-holder">
                                <img src="<?php /* @escapeNotVerified */ echo $block->getImageUrl($_product) ?>" alt="<?php /* @escapeNotVerified */ echo __('Product image') ?>" />
                            </div>
                            <div class="info-block">
                                <?php foreach($block->getAttributesToDisplay($_product) as $attribute): ?>
                                    <?php /* @escapeNotVerified */ echo $attribute->render() ?>
                                <?php endforeach; ?>
                            </div>
                            <div class="controlbar-bottom">
                                <div class="position">
                                    <label for="id_position_<?php /* @escapeNotVerified */ echo $_index ?>"><?php /* @escapeNotVerified */ echo __('Position') ?></label>
                                    <div>
                                        <a href="#" class="move-top icon-backward"><span><?php /* @escapeNotVerified */ echo __('Top') ?></span></a>
                                        <input type="text" name="position" id="id_position_<?php /* @escapeNotVerified */ echo $_index ?>" value="<?php echo $block->escapeHtml($_product->getPosition()) ?>" />
                                        <a href="#" class="move-bottom icon-forward"><span><?php /* @escapeNotVerified */ echo __('Bottom') ?></span></a>
                                    </div>
                                </div>
                                <input type="hidden" name="entity_id" value="<?php /* @escapeNotVerified */ echo $_product->getId() ?>" />
                            </div>
                        </li>
                    <?php endforeach; ?>
                </ul>
            </div>
        </div>
    <?php endif; ?>
</div>

<script type="text/x-magento-init">
{
    "[data-role=catalog_category_merchandiser]": {
        "Magento_VisualMerchandiser/js/pager": {
            "gridUrl": "<?php /* @escapeNotVerified */ echo $block->getGridUrl() ?>",
            "varNamePage": "<?php /* @escapeNotVerified */ echo $block->getVarNamePage() ?>"
        }
    }
}
</script>
